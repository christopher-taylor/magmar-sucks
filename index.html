<html>

<head>
    <title>Magmar Sucks - The Ranking of Pokemon</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="google-site-verification" content="q8wMroFDTb5WMGRz7PYH4ohR2U8VAhXxjcJuKY9_K9g" />

    <!-- Handlebars -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.0.5/handlebars.min.js" integrity="sha256-rMOSOM5HDzVEMoVZTv2189+RKSTSgY5ZKfTfap7q2zE=" crossorigin="anonymous"></script>

    <!-- Bootstrap 4 -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.1.1.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js" integrity="sha384-DztdAPBWPRXSA/3eYEEUWrWCy7G5KFbe8fFjk5JAIxUYHKkDx6Qin1DkWx51bBrb" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js" integrity="sha384-vBWWzlZJ8ea9aCX4pEW3rVHjgjt7zpkNpZk+02D9phzyeVkE+jo0ieGizqPLForn" crossorigin="anonymous"></script>
    <!-- / Bootstrap 4 -->

    <!-- Markdown to HTML -->
    <script src="https://cdn.rawgit.com/showdownjs/showdown/1.6.4/dist/showdown.min.js"></script>
</head>

<body class="container">
    <div class="row mb-2">
        <img class="img-fluid" src="./assets/images/banner-md.png" title="This is a banner image, it's pretty shit." alt="This is a banner image, it's pretty shit.">
    </div>
    <div class="row">
        <div class="col-sm-10">
            <p>Pokemon are loved by all, unless you're Magmar - if you're Magmar, you suck. From the depths of the Pokedex, we bring you a discussion about the world most (un)interesting Pokemon, and rank them from most to least interesting, one Pokemon
                at a time.</p>
            <p>
                Episodes generally release every other day.
            </p>
        </div>
        <div class='col-sm-2'>
            Subscribe On:
            <a href='https://playmusic.app.goo.gl/?ibi=com.google.PlayMusic&amp;isi=691797987&amp;ius=googleplaymusic&amp;link=https://play.google.com/music/m/I6x5pmmhw5dzo52nb6vplkuerza?t%3DMagmar_Sucks%26pcampaignid%3DMKT-na-all-co-pr-mu-pod-16' rel='nofollow'><img class="w-100" alt='Get it on Google Play' src='./assets/images/play-badge.png' />
            <br>
            <a href="https://geo.itunes.apple.com/us/podcast/magmar-sucks/id1125767902?mt=2">
                <img class="w-100" alt="Get it on iTunes" src="./assets/images/itunes-badge.png" />
            </a>
        </div>
    </div>

    <nav>
        <ul class="nav nav-tabs">
            <li class="nav-item">
                <a class="nav-link active" data-toggle="tab" href="#currentOutput" role="tab">Current</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" data-toggle="tab" href="#pre2Output" role="tab" onclick="renderRanking('preUpdate2', 'pre2Output');">E056-E130</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" data-toggle="tab" href="#pre1Output" role="tab" onclick="renderRanking('preUpdate1', 'pre1Output');">E000-E055</a>
            </li>
        </ul>
    </nav>

    <main class="tab-content">
        <div class="tab-pane fade show active" id="currentOutput" role="tabpanel"></div>
        <div class="tab-pane fade" id="pre2Output" role="tabpanel"></div>
        <div class="tab-pane fade" id="pre1Output" role="tabpanel"></div>
    </main>

    <script id="current" type="text/x-handlebars-template">
        {{#each datas as |tier|}}
        <div class="card mb-2">
            <div class="card-block">
                <div class='card-title text-center'>
                    <h4>{{@key}}</h4>
                </div>
                <table class="table table-striped">
                    {{> headers}}
                    <tbody>
                        {{#each tier as |poke|}} {{> row}} {{/each}}
                    </tbody>
                </table>
            </div>
        </div>
        {{/each}}
    </script>

    <!-- Partials: Change these to change the table layout -->
    <script id="table-headers-partial" type="text/x-handlebars-template">
        <thead class="table-inverse">
            <tr>
                <th class="fit">
                    Pok&eacute;dex
                </th>
                <th class="fit">
                    Name
                </th>
                <th>
                    Description
                </th>
                <th class="fit"></th>
            </tr>
        </thead>
    </script>

    <script id="poke-row-partial" type="text/x-handlebars-template">
        {{#if d}}
        <tr>
            <td class="fit">
                #{{b}}
            </td>
            <td class="fit">
                <a href="http://bulbapedia.bulbagarden.net/wiki/{{a}}">{{a}}</a>
            </td>
            <td>
                {{e}}
                <div data-show-notes-holder="{{d}}">
                </div>
            </td>
            <td>
                <a href="#{{d}}" data-toggle='collapse' onclick="renderMoreInfo({{d}})">Listen</a>
            </td>
        </tr>
        {{/if}}
    </script>

    <script id="more-info-partial" type="text/x-handlebars-template">
        <div class="collapse pt-2" data-collapse-id="{{datas.id}}">
            <iframe class="mb-2" frameborder='0' height='36px' scrolling='no' seamless src='https://simplecast.com/e/{{datas.id}}?style=light' width='100%'></iframe>
            <div data-show-notes-container="{{datas.id}}">
                {{datas.showNotes}}
            </div>
        </div>
    </script>


    <script>
        const MORE_INFO_TEMPLATE = Handlebars.compile($('#more-info-partial').html());
        const RANKING_TEMPLATE = Handlebars.compile($('#current').html());
        const CONVERTER = new showdown.Converter()
        $(document).ready(function() {
            registerTemplates();
            renderRanking('ranking', 'currentOutput');
        });

        function registerTemplates() {
            Handlebars.registerPartial("headers", $("#table-headers-partial").html());
            Handlebars.registerPartial("row", $("#poke-row-partial").html());
            Handlebars.registerPartial("more-info", $("#more-info-partial").html());
        }

        function renderRanking(file, outlet) {
            $('#' + outlet).empty();
            $.getJSON("./assets/data/rankings/" + file + ".json", function(data) {
                var html = RANKING_TEMPLATE({
                    datas: data
                });
                $('#' + outlet).prepend(html);
            });
        }

        function renderMoreInfo(episodeId) {
            if (!$('.tab-pane.active [data-show-notes-container=' + episodeId + ']').length) {
                $.getJSON('./assets/data/episode-data/' + episodeId + '.json', function(data) {
                    var showNotes = CONVERTER.makeHtml(data.long_description);
                    var html = MORE_INFO_TEMPLATE({
                        datas: data
                    });
                    $('.tab-pane.active [data-show-notes-holder=' + episodeId + ']').append(html);
                    $('.tab-pane.active [data-show-notes-container=' + episodeId + ']').append(showNotes);
                    $('.tab-pane.active [data-collapse-id=' + episodeId + ']').collapse('toggle');
                });
            } else {
                $('.tab-pane.active [data-collapse-id=' + episodeId + ']').collapse('toggle');
            }
        }
    </script>
</body>

</html>
